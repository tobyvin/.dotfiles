#!/usr/bin/env bash

[[ -n "$TMUX" ]] && change="switch-client" || change="attach-session"
session=$(
    tmux list-sessions -F "#{session_name}" 2>/dev/null |
        sed "/^$(tmux display-message -p '#S' 2>/dev/null)$/d" |
        fzf --query="$1" --select-1 --exit-0
) &&
    tmux $change -t "$session" ||
    (
        tmux new-session -d -s $session &&
            tmux $change -t "$session"
    )
