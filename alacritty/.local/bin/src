#!/bin/sh

if [ ! -d "$1" ]; then
	project="$(
		projectr -mgE ~/.local/src |
			fzf --tmux --tac -0 -1 -d/ --with-nth=-1 --preview='lesspipe.sh {}' --query="$1"
	)"
	if [ -z "$project" ]; then
		exit 0
	fi
	set -- "$project"
fi

if [ ! -d "$1" ]; then
	exit 1
fi

alacritty msg create-window -T"$(basename "$1")" --working-directory="$1"
